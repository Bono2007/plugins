var exports=function(e){"use strict";const t="\\d{4}-[01]\\d{1}-\\d{2}",n="[0-2]\\d{1}:[0-5]\\d{1}\\s?(?:AM|PM|am|pm)?";function o(e,t){const n=new Date(e);let o=0;const a=t.charAt(t.length-1);let c=Number(t.substr(0,t.length-1));switch(a){case"b":{const e=n.getUTCDay();let t;t=c<0?(e-12)%7:(e+6)%7,6===t&&c--,-6===t&&c++;o=c+2*Math.trunc((c+t)/5);break}case"d":o=1*c;break;case"w":o=7*c;break;case"m":o=30*c;break;case"q":o=91*c;break;case"y":o=365*c;break;default:console.log("\tError in c_o_d from ".concat(n," by ").concat(t))}const l=new Date(n);l.setDate(n.getDate()+o);return l.toISOString().slice(0,10)}return(new Date).toISOString().slice(0,10),(new Date).toISOString().slice(0,16),e.repeats=async function(){const e="\\s+>(".concat(t,")"),a="".concat(t," ").concat(n),c="@done\\(".concat(a,"\\)"),l="@done\\((".concat(t,")( ").concat(n,")\\)"),{paragraphs:r,title:s}=Editor;if(null===r)return void console.log("repeat: warning: No note open, or empty note.");let i=r.length;console.log("\nrepeats: from note '".concat(s,"'")),null===r[i]&&i--;let d=0,g=0;for(let e=0;e<i;e++){const t=r[e];2===t.headingLevel&&"Done"===t.content&&(d=e),2===t.headingLevel&&"Cancelled"===t.content&&(g=e)}const p=d>0?d:g>0?g:i;let u=0,h="",m="",f="",w="",b=[];for(u=0;u<p;u++){const t=r[u];if(h=t.content,m="",f="",t.content.match(c)&&(b=h.match(l),f=b[1],w=b[2],console.log("  Found completed repeat ".concat(f,"/").concat(w," in line ").concat(u)),m=h.replace(w,""),t.content=m,await Editor.updateParagraph(t),m.match("@repeat\\(\\+?\\d+[bdwmqy]\\)"))){let n="",a="";b=m.match("@repeat\\((.*?)\\)");let c=b[1];if(console.log("\tFound EXTENDED @repeat syntax: ".concat(c)),"+"===c[0])c=c.substring(1,c.length),n=o(f,c),console.log("\tAdding from completed date --\x3e ".concat(n)),m=m.replace(/\s+>\d{4}-[01]\d{1}-\d{2}/,"");else{var y;let t="";const a=null!==(y=m.match(e))&&void 0!==y?y:[];console.log(a.length),null!=a[1]?(console.log("\tmatch => ".concat(a[1])),t=a[1],m=m.replace(">".concat(t),"")):t=f,n=o(t,c),console.log("\tAdding from due date --\x3e ".concat(n))}if(a=m.replace(/@done\(.*\)/,"").trim(),"Notes"===Editor.type)a+=" >".concat(n),await Editor.insertParagraphAfterParagraph(a,t,"scheduled"),console.log("\tInserted new para after line ".concat(t.lineIndex));else{const e=n.replace(/-/g,""),o=await DataStore.calendarNoteByDateString(e);null!=o.title?(await o.appendTodo(a),console.log("\tInserted new repeat in daily note ".concat(e))):(a+=" >".concat(n),console.log("\toutline: ".concat(a)),await Editor.insertParagraphAfterParagraph(a,t,"scheduled"),console.log("\tInserted new repeat in original daily note"))}}}},Object.defineProperty(e,"__esModule",{value:!0}),e}({});Object.assign(globalThis,exports);
