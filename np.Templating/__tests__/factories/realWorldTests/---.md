---
title: Weather 5-Day
step1: go to OpenWeatherMap and sign up for a free account https://home.openweathermap.org/users/sign_up
step2: get an API KEY https://home.openweathermap.org/api_keys and paste it below
step3:
  - find the lat/long for your location by going to google maps https://www.google.com/maps
  - searching for an address and then right-clicking that address on a map. Insert your
step4: set what type of units you want your result returned in - metric (for \xB0C)
api_key: 11634c5bc8f3ac1841442085146b969a
lat: 40.662102
long: -73.955
units: imperial
type: empty-note
---
```templatejs

/**
 * Generates a 5-day weather forecast from the given weather data.
 * @param {Object} weatherData - The JSON response from the weather API.
 * @returns {string} A formatted 5-day weather forecast.
 */
function generateWeatherForecast(weatherData) {
    const forecastLines = [];
    const daysProcessed = new Set();
    const timezoneOffset = weatherData.city.timezone; // Timezone offset in seconds

    // Array of day names
    const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

    weatherData.list.forEach((entry) => {
        // Adjust the timestamp by the timezone offset
        const localTimestamp = entry.dt + timezoneOffset;
        const date = new Date(localTimestamp * 1000);
        const dayIndex = date.getUTCDay(); // Get the day of the week (0-6)
        const dayName = dayNames[dayIndex]; // Map to day name
        const day = date.toISOString().split('T')[0]; // Extract the date part

        if (!daysProcessed.has(day)) {
            const temp = Math.round(entry.main.temp);
            const feelsLike = Math.round(entry.main.feels_like);
            const description = entry.weather[0].description;
            const windSpeed = Math.round(entry.wind.speed);
            const windDirection = entry.wind.deg;

            const forecastLine = `**${dayName}, ${day}**: ${capitalizeFirstLetterOfEachWord(description)}, ${temp}°F, Feels like: ${feelsLike}°F, Wind: ${windSpeed} mph`;
            forecastLines.push(forecastLine);
            daysProcessed.add(day);
        }

        // Stop after processing 5 days
        if (daysProcessed.size >= 5) {
            return;
        }
    });

    return forecastLines.join('\n');
}

function capitalizeFirstLetterOfEachWord(str) {
    return str.replace(/\b\w/g, char => char.toUpperCase());
}

const weatherURL = `https://api.openweathermap.org/data/2.5/forecast?lat=${LAT}&lon=${LONG}&units=imperial&appid=${API_KEY}`;
console.log(`Weather Calling: "${weatherURL}"`);

const jsonIn = await fetch(weatherURL);
const weatherData = JSON.parse(jsonIn);

if (!weatherData || !weatherData.list) return `Error received from server: ${weatherData.message}`;

clo(weatherData,`Template weatherData`);

const cityName = weatherData.city?.name || ''
const weatherLine = generateWeatherForecast(weatherData); 
```
## <%- cityName %> Weather Forecast
<%- weatherLine %>

Error received from server: Invalid API key. Please see https://openweathermap.org/faq#error401 for more info.